<%- include('../cabecalho.ejs') %>

<header>
  <div class="title2">Editar instrutor</div>
  <div class="subtitle">Atualize as informações do instrutor</div><br>
</header>

<div class="content">
  <form id="form-instrutor" 
        autocomplete="off" 
        method="post"
        action="/instrutor/edt/<%= instrutor._id %>">

    <!-- FOTO DO INSTRUTOR -->
    <div>
      <label for="foto">Foto do instrutor</label>

      <div style="margin-bottom:8px;">
        <img id="fotoPreview"
             src="<%= instrutor.fotoBase64 ? instrutor.fotoBase64 : '/img/default-pfp.png' %>"
             style="width:120px; height:120px; border-radius:50%; object-fit:cover; border:1px solid #ccc;">
      </div>

      <!-- Input da imagem -->
      <input type="file" id="foto" accept="image/*">

      <!-- Campo escondido que vai pro backend -->
      <input type="hidden" id="fotoBase64" name="fotoBase64" value="<%= instrutor.fotoBase64 %>">
    </div>

    <div>
      <label for="nome">Nome</label>
      <input id="nome" name="nome" type="text" value="<%= instrutor.nome %>" required>
    </div>

    <div>
      <label for="cpf">CPF</label>
      <input id="cpf" name="cpf" type="text" value="<%= instrutor.cpf %>" required>
    </div>

    <div>
      <label for="telefone">Telefone</label>
      <input id="telefone" name="telefone" type="text" value="<%= instrutor.telefone %>" required>
    </div>

    <div>
      <label for="especialidade">Especialidade</label>
      <select id="especialidade" name="especialidade" required>

        <option value="" disabled>Selecione</option>

        <option value="ganho_de_massa"
          <%= instrutor.especialidade === "ganho_de_massa" ? "selected" : "" %>>
          Ganho de massa
        </option>

        <option value="emagrecimento"
          <%= instrutor.especialidade === "emagrecimento" ? "selected" : "" %>>
          Emagrecimento
        </option>

        <option value="resistencia"
          <%= instrutor.especialidade === "resistencia" ? "selected" : "" %>>
          Resistência
        </option>

        <option value="condicionamento_fisico"
          <%= instrutor.especialidade === "condicionamento_fisico" ? "selected" : "" %>>
          Condicionamento físico
        </option>

        <option value="reabilitacao"
          <%= instrutor.especialidade === "reabilitacao" ? "selected" : "" %>>
          Reabilitação
        </option>

      </select>
    </div>

    <div>
      <label for="email">Email</label>
      <input id="email" name="email" type="email" value="<%= instrutor.email %>" required>
    </div>

    <footer style="margin-top:20px;">
      <a class="btn ghost" href="/instrutor/lst">Cancelar</a>
      <button type="submit" class="btn primary">Salvar alterações</button>
    </footer>

  </form>
</div>

<script>
document.getElementById('foto').addEventListener('change', function (event) {
  const file = event.target.files[0];
  if (!file) return;

  const reader = new FileReader();

  reader.onload = function(e) {
    // Preenche o campo hidden
    document.getElementById('fotoBase64').value = e.target.result;

    // Mostra a foto no preview
    document.getElementById('fotoPreview').src = e.target.result;
  };

  reader.readAsDataURL(file);
});
</script>

<%- include('../rodape.ejs') %>
